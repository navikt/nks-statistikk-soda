filter chat_enhet [begrenset]:
  where: date > DATE('${NOW}') - 7

filter chat_kanalstatistikk [begrenset]:
  where: date > DATE('${NOW}') - 7
     
checks for chat_enhet [begrenset]:
  - freshness(date) < 1d: 
      name: "Sjekker om data er mer enn ett døgn gamle"

checks for chat_kanalstatistikk [begrenset]:
  - freshness(date) < 1d: 
      name: "Sjekker om data er mer enn ett døgn gamle"
          
checks for chat_concurrency:
  - UpdatedDateOk > 0:
      name: "Sjekker om data er mer enn ett døgn gamle (hvis igår var hverdag)"
      UpdatedDateOk query: |
            SELECT 
              CASE 
                WHEN EXTRACT(DAYOFWEEK FROM CURRENT_DATE())  in (1,2) THEN 2
                WHEN DATE(MAX(date)) >= (CURRENT_DATE() -1) THEN 1 
                ELSE 0 
              END
            FROM chat_concurrency 
            WHERE date > CURRENT_DATE() - 7